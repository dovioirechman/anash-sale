// רשימת ערים בישראל לזיהוי (ממוינת לפי אורך - הארוכה ביותר קודם)
const ISRAELI_CITIES = [
  // ערים גדולות
  'ירושלים', 'תל אביב', 'חיפה', 'באר שבע', 'ראשון לציון', 'פתח תקווה', 'אשדוד', 'נתניה',
  'בני ברק', 'חולון', 'רמת גן', 'אשקלון', 'בת ים', 'רחובות', 'הרצליה', 'כפר סבא',
  'חדרה', 'בית שמש', 'מודיעין', 'רעננה', 'לוד', 'רמלה', 'גבעתיים', 'נהריה', 'עכו',
  'קריית גת', 'קרית גת', 'אילת', 'עפולה', 'נצרת', 'כרמיאל', 'טבריה', 'צפת', 'דימונה',

  // ערים וישובים חרדיים
  'אלעד', 'ביתר עילית', 'מודיעין עילית', 'עמנואל', 'קריית ספר', 'קרית ספר', 'בית שמש',
  'רכסים', 'קריית יערים', 'קרית יערים', 'טלזסטון', 'זכרון יעקב',

  // ערי פיתוח ופריפריה
  'שדרות', 'קריית שמונה', 'קרית שמונה', 'מגדל העמק', 'יקנעם', 'טירת הכרמל', 'נשר',
  'קריית אתא', 'קרית אתא', 'קריית ביאליק', 'קרית ביאליק', 
  'קריית מוצקין', 'קרית מוצקין', 'קריית ים', 'קרית ים',
  'אור עקיבא', 'פרדס חנה', 'זכרון יעקב', 'בנימינה', 'עתלית',

  // גוש דן
  'גבעת שמואל', 'אור יהודה', 'יהוד', 'קריית אונו', 'קרית אונו', 'סביון', 'גני תקווה',
  'כפר שמריהו', 'רמת השרון', 'הוד השרון', 'כפר יונה', 'אבן יהודה',

  // השפלה והשרון
  'מזכרת בתיה', 'גדרה', 'יבנה', 'נס ציונה', 'ראש העין',
  'שוהם', 'קדימה', 'צורן', 'פרדסיה',

  // דרום
  'אופקים', 'נתיבות', 'ירוחם', 'מצפה רמון', 'ערד', 'קריית מלאכי', 'קרית מלאכי',

  // יהודה ושומרון
  'אריאל', 'מעלה אדומים', 'גבעת זאב', 'אפרת', 'קריית ארבע', 'קרית ארבע', 'חברון',
  'קדומים', 'כרמי צור', 'אלון שבות', 'נוה צוף', 'בית אל',

  // צורות נפוצות נוספות
  'תל-אביב', 'ת"א', 'ב"ב', 'פ"ת', 'ר"ג', 'ר"ל', 'כ"ס',
  'גבעת שאול', 'רמות', 'הר נוף', 'גאולה', 'מאה שערים', 'סנהדריה',
  'נווה יעקב', 'פסגת זאב', 'רמת שלמה', 'קרית משה', 'קריית משה',

  // שכונות ידועות בב"ב
  'פרדס כץ', 'קריית הרצוג', 'קרית הרצוג', 'ויז\'ניץ', 'זכרון מאיר',

  // כפר חב"ד
  'כפר חב״ד', 'כפר חבד', 'נחלת הר חב״ד', 'נחלת הר חבד',

  // שכונות ידועות בלוד
  'אחיסמך'
].sort((a, b) => b.length - a.length); // מיון לפי אורך - הארוכה ביותר קודם

// זיהוי עיר בטקסט
export function detectCity(text) {
  if (!text) return null;

  const normalizedText = text.toLowerCase();

  for (const city of ISRAELI_CITIES) {
    // בדיקה ישירה - הערים ממוינות לפי אורך אז התאמה יותר ספציפית תימצא קודם
    if (normalizedText.includes(city.toLowerCase())) {
      return city;
    }
  }

  return null;
}

// זיהוי עיר במודעה (כותרת + תוכן)
export function detectCityInArticle(article) {
  // קודם בכותרת
  let city = detectCity(article.title);
  if (city) return city;

  // אחר כך בתוכן
  city = detectCity(article.content);
  if (city) return city;

  // בסיכום
  city = detectCity(article.summary);
  return city;
}

// רשימת קטגוריות דירות
export const APARTMENT_CATEGORIES = [
  'דירות להשכרה',
  'דירות למכירה',
  'דירות',
  'נדל״ן',
  'נדל"ן',
  'נדל״ן בלוד',
];

// בדיקה אם קטגוריה היא של דירות
export function isApartmentCategory(topic) {
  return APARTMENT_CATEGORIES.some(cat =>
    topic?.includes(cat) || cat.includes(topic)
  );
}

